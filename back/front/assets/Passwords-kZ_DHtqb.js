import{h as w,i as _,j as C,r as c,o as a,a as t,c as o,d as y,F as B,k as M,t as n,w as j}from"./index-3_QW8fVA.js";import{_ as A}from"./Layout-BT1vI15I.js";import{a as P,d as V,c as $}from"./borgPasswordDB-R24cjgOz.js";import"./index-Cxajs7nX.js";const D={class:"space-y-6"},z={class:"flex items-center justify-between"},H={key:0,class:"flex justify-center py-12"},L={key:1,class:"text-center py-12"},N={key:2,class:"space-y-3"},F={class:"flex items-center justify-between gap-3"},E={class:"min-w-0 flex-1"},I={class:"flex items-center space-x-2"},T={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},q={class:"mt-1 flex items-center space-x-3"},G={class:"text-xs text-gray-500 dark:text-gray-400"},J=["onClick"],K={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},O=["onClick"],Q={class:"bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 max-w-sm w-full"},R={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},S={class:"text-sm text-gray-600 dark:text-gray-400 mb-5"},U={class:"flex justify-end space-x-3"},et={__name:"Passwords",setup(W){const u=c(!0),d=c([]),l=c(!1),x=c(""),v=c("");let i=null;w(async()=>{await g()});async function g(){u.value=!0;try{const s=await P();d.value=s.map(e=>({...e,visible:!1}))}catch(s){console.error("加载密码失败:",s)}finally{u.value=!1}}function f(s){s.visible=!s.visible}function k(s){x.value="删除密码",v.value=`确定要删除仓库「${s}」的保存密码吗？`,i=async()=>{await V(s),await g()},l.value=!0}function m(){x.value="清除全部密码",v.value="确定要清除所有已保存的 Borg 仓库密码吗？此操作不可撤销。",i=async()=>{await $(),await g()},l.value=!0}async function h(){if(l.value=!1,i){try{await i()}catch(s){console.error("操作失败:",s)}i=null}}function p(s){if(!s)return"";try{return new Date(s).toLocaleString("zh-CN")}catch{return s}}return(s,e)=>(a(),_(A,null,{default:C(()=>[t("div",D,[t("div",z,[e[2]||(e[2]=t("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," 密码管理 ",-1)),d.value.length>0?(a(),o("button",{key:0,onClick:m,class:"px-3 py-1.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors"}," 清除全部 ")):y("",!0)]),e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 管理已保存在浏览器中的 Borg 仓库密码。密码仅存储在本地浏览器的 IndexedDB 中，不会上传到服务器。 ",-1)),u.value?(a(),o("div",H,[...e[3]||(e[3]=[t("svg",{class:"animate-spin h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)])])):d.value.length===0?(a(),o("div",L,[...e[4]||(e[4]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"没有保存的密码",-1),t("p",{class:"text-sm text-gray-400 dark:text-gray-500 mt-1"}," 在 Borg 备份页面展开仓库时可以选择保存密码 ",-1)])])):(a(),o("div",N,[(a(!0),o(B,null,M(d.value,r=>(a(),o("div",{key:r.repoPath,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},[t("div",F,[t("div",E,[t("div",I,[e[5]||(e[5]=t("svg",{class:"w-4 h-4 text-green-600 dark:text-green-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})],-1)),t("p",T,n(r.repoPath),1)]),t("div",q,[t("span",G," 密码: "+n(r.visible?r.passphrase:"••••••••"),1),t("button",{onClick:b=>f(r),class:"text-xs text-blue-600 dark:text-blue-400 hover:underline"},n(r.visible?"隐藏":"显示"),9,J)]),t("p",K," 保存于: "+n(p(r.savedAt)),1)]),t("button",{onClick:b=>k(r.repoPath),class:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors shrink-0",title:"删除"},[...e[6]||(e[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,O)])]))),128))])),l.value?(a(),o("div",{key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4",onClick:e[1]||(e[1]=j(r=>l.value=!1,["self"]))},[t("div",Q,[t("h3",R,n(x.value),1),t("p",S,n(v.value),1),t("div",U,[t("button",{onClick:e[0]||(e[0]=r=>l.value=!1),class:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," 取消 "),t("button",{onClick:h,class:"px-4 py-2 text-sm bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors"}," 确认删除 ")])])])):y("",!0)])]),_:1}))}};export{et as default};
